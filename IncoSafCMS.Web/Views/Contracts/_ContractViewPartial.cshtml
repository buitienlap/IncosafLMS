@*
    @using IncosafCMS.Web.Providers;
    @using System.Linq;
    @using IncosafCMS.Data;
*@

@{
    Html.EnableClientValidation();
    Html.EnableUnobtrusiveJavaScript();

    bool showExtraColumns = ViewBag.ShowContractExtraColumns ?? false;
    var grid = Html.DevExpress().GridView(settings =>
    {
        settings.Name = "grvContracts";


        settings.KeyFieldName = "Id";

        settings.CallbackRouteValues = new { Controller = "Contracts", Action = "ContractViewPartial" };
        settings.CustomBindingRouteValuesCollection.Add(GridViewOperationType.Paging, new { Controller = "Contracts", Action = "AdvancedCustomBindingPagingAction" });
        settings.CustomBindingRouteValuesCollection.Add(GridViewOperationType.Filtering, new { Controller = "Contracts", Action = "AdvancedCustomBindingFilteringAction" });
        settings.CustomBindingRouteValuesCollection.Add(GridViewOperationType.Sorting, new { Controller = "Contracts", Action = "AdvancedCustomBindingSortingAction" });
        settings.CustomBindingRouteValuesCollection.Add(GridViewOperationType.Grouping, new { Controller = "Contracts", Action = "AdvancedCustomBindingGroupingAction" });

        settings.SettingsEditing.AddNewRowRouteValues = new { Controller = "Contracts", Action = "ContractAddNewPartial" };
        settings.SettingsEditing.UpdateRowRouteValues = new { Controller = "Contracts", Action = "ContractUpdatePartial" };
        settings.SettingsEditing.DeleteRowRouteValues = new { Controller = "Contracts", Action = "ContractDeletePartial" };

        settings.CustomActionRouteValues = new { Controller = "Contracts", Action = "ContractGridRouter" };

        settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);

        settings.SettingsText.CommandNew = "Thêm";
        settings.SettingsText.CommandEdit = "Sửa";
        settings.SettingsText.CommandDelete = "Xóa";
        settings.SettingsText.PopupEditFormCaption = "Thêm/Sửa dữ liệu";
        settings.SettingsText.SearchPanelEditorNullText = "Nhập từ khóa tìm kiếm...";
        settings.SettingsSearchPanel.AllowTextInputTimer = false;
        settings.SettingsText.EmptyDataRow = "Không có kết quả nào";

        settings.SettingsEditing.Mode = GridViewEditingMode.PopupEditForm;

        settings.SettingsBehavior.ConfirmDelete = true;
        settings.SettingsBehavior.AllowFixedGroups = true;
        settings.SettingsBehavior.AllowFocusedRow = true;

        settings.SettingsPopup.EditForm.Modal = true;
        settings.SettingsPopup.EditForm.HorizontalAlign = PopupHorizontalAlign.Center;
        settings.SettingsPopup.EditForm.VerticalAlign = PopupVerticalAlign.NotSet;
        settings.SettingsLoadingPanel.Text = "Đang tải...";
        settings.SettingsLoadingPanel.Mode = GridViewLoadingPanelMode.ShowAsPopup;

        settings.KeyboardSupport = true;
        settings.AccessKey = "D";

        settings.Styles.Header.Paddings.PaddingTop = System.Web.UI.WebControls.Unit.Pixel(5);
        settings.Styles.Header.Paddings.PaddingBottom = System.Web.UI.WebControls.Unit.Pixel(5);
        settings.Styles.Cell.Paddings.PaddingTop = System.Web.UI.WebControls.Unit.Pixel(2);
        settings.Styles.Cell.Paddings.PaddingBottom = System.Web.UI.WebControls.Unit.Pixel(2);
        settings.ControlStyle.Border.BorderStyle = System.Web.UI.WebControls.BorderStyle.None;

        //settings.Settings.VerticalScrollBarMode = ScrollBarMode.Auto;
        //settings.Settings.HorizontalScrollBarMode = ScrollBarMode.Visible;//Bật cuộn ngang
        settings.Settings.VerticalScrollBarMode = ScrollBarMode.Visible;//Bật cuộn đứng

        settings.SettingsPager.Summary.EmptyText = "Không có dữ liệu để đánh số trang";
        settings.SettingsPager.Summary.AllPagesText = "Trang {0}/{1} ({2} kết quả)";
        settings.SettingsPager.Summary.Text = "Trang {0}/{1} ({2} kết quả)";
        settings.SettingsPager.PageSize = 30; //Đặt số dòng thực sự ở CreateGridViewModelWithSummary trong ContractController
        settings.SettingsPager.Mode = GridViewPagerMode.ShowPager;
        settings.SettingsPager.AllButton.Visible = false;
        settings.SettingsPager.LastPageButton.Visible = false;
        settings.SettingsPager.FirstPageButton.Visible = false;
        settings.SettingsPager.NumericButtonCount = 5;

        settings.SettingsSearchPanel.Visible = false;//ẩn 30.10.2025
        settings.SettingsSearchPanel.ColumnNames = "MaHD; Name; OwnerDisplayName; KDV1DisplayName; KDV2DisplayName; CustomerName";

        settings.SettingsContextMenu.Enabled = false;

        settings.SettingsBehavior.AllowEllipsisInText = false;
        settings.SettingsContextMenu.Enabled = true;
        settings.SettingsContextMenu.RowMenuItemVisibility.DeleteRow = false;
        settings.SettingsContextMenu.RowMenuItemVisibility.EditRow = false;
        settings.SettingsContextMenu.RowMenuItemVisibility.NewRow = false;
        settings.SettingsContextMenu.RowMenuItemVisibility.ExpandRow = false;
        settings.SettingsContextMenu.RowMenuItemVisibility.CollapseRow = false;
        settings.SettingsContextMenu.RowMenuItemVisibility.Refresh = false;
        settings.SettingsContextMenu.RowMenuItemVisibility.GroupSummaryMenu.Visible = false;
        settings.SettingsContextMenu.EnableColumnMenu = DefaultBoolean.False;
        settings.SettingsContextMenu.EnableFooterMenu = DefaultBoolean.False;
        settings.SettingsContextMenu.EnableGroupFooterMenu = DefaultBoolean.False;
        settings.SettingsContextMenu.EnableGroupPanelMenu = DefaultBoolean.False;

        settings.FillContextMenuItems = (sender, e) =>
        {
            if (e.MenuType == GridViewContextMenuType.Rows)
            {
                // Menu cho Status
                //e.Items.Add("Chờ duyệt", "Waiting", "/Images/waiting.png");
                //e.Items.Add("Đã duyệt", "Approved", "/Images/approved.png");
                e.Items.Add("Cấp số", "SetContractNumber", "/Images/setcontractnumber.png");

                // Menu cho Document
                e.Items.Add("Xem hồ sơ", "ViewDocument", "/Images/pdfview.png");
                e.Items.Add("Upload hồ sơ", "UploadDocument", "/Images/pdffile.png");
            }
        };

        settings.ClientSideEvents.ContextMenuItemClick = "ApprovedMenuClick";

        settings.Toolbars.Add(toolbar =>
        {
            toolbar.Enabled = true;
            toolbar.Visible = false;
            toolbar.Position = GridToolbarPosition.Top;
            toolbar.ItemAlign = GridToolbarItemAlign.Justify;
            toolbar.Items.Add(i =>
            {
                i.Text = "Làm mới lại dữ liệu";
                i.Name = "RefreshContractData";
                i.Image.IconID = DevExpress.Web.ASPxThemes.IconID.ActionsRefresh16x16gray;
            });
        });

        settings.ClientSideEvents.ToolbarItemClick = "ContractToolBarClick";

        settings.Columns.Add(column =>
        {
            column.Caption = "Id";
            column.FieldName = "Id";
            column.Visible = false;
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Mã HĐ";
            column.FieldName = "MaHD";
            column.Width = System.Web.UI.WebControls.Unit.Pixel(60);
            column.CellStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Left;
            column.Settings.AutoFilterCondition = AutoFilterCondition.Contains;
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Tên hợp đồng";
            column.FieldName = "Name";
            column.Settings.AutoFilterCondition = AutoFilterCondition.Contains;
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Ngày ký";
            column.FieldName = "SignDate";
            column.Width = System.Web.UI.WebControls.Unit.Pixel(100);
            column.ColumnType = MVCxGridViewColumnType.DateEdit;
            column.UnboundType = DevExpress.Data.UnboundColumnType.DateTime;
            column.PropertiesEdit.DisplayFormatString = "dd/MM/yyyy";
            column.UnboundExpression = "AddMonths(AddDays(Today(), [ReorderLevel]), -1)";
            column.SortOrder = DevExpress.Data.ColumnSortOrder.Descending;

        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Chủ trì";
            column.FieldName = "OwnerDisplayName";
            column.Width = System.Web.UI.WebControls.Unit.Pixel(140);
            column.Settings.AutoFilterCondition = AutoFilterCondition.Contains;
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Khách hàng";
            column.FieldName = "CustomerName";
            column.Settings.AutoFilterCondition = AutoFilterCondition.Contains;
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Giá trị HĐ";
            column.FieldName = "Value";
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.Width = System.Web.UI.WebControls.Unit.Pixel(105);
            column.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;

            // ✅ Header hiển thị tên cột + tổng
            column.SetHeaderTemplateContent(c =>
            {
                var total = string.Format("{0:N0}", ViewBag.Total_Value ?? 0);
                ViewContext.Writer.Write(
                    "<div style='text-align:center; line-height:1.2;'>" +
                        "<div>Giá trị HĐ</div>" +
                        "<div style='color:#007bff; font-weight:bold; font-size:13px;'>" + total + "</div>" +
                    "</div>"
                );
            });

        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Xuất h.đơn";
            column.FieldName = "XuatHoaDon";
            column.CellStyle.ForeColor = System.Drawing.Color.DarkBlue;
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.Visible = showExtraColumns;
            column.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Width = 105;
            // ✅ Header hiển thị tên cột + tổng
            column.SetHeaderTemplateContent(c =>
            {
                var total = string.Format("{0:N0}", ViewBag.Total_XuatHoaDon ?? 0);
                ViewContext.Writer.Write(
                    "<div style='text-align:center; line-height:1.2;'>" +
                        "<div>Xuất h.đơn</div>" +
                        "<div style='color:#007bff; font-weight:bold; font-size:13px;'>" + total + "</div>" +
                    "</div>"
                );
            });
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Thu nợ";
            column.FieldName = "ThuNo";
            column.CellStyle.ForeColor = System.Drawing.Color.Blue;
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.Visible = showExtraColumns;
            column.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Width = 105;
            // ✅ Header hiển thị tên cột + tổng
            column.SetHeaderTemplateContent(c =>
            {
                var total = string.Format("{0:N0}", ViewBag.Total_ThuNo ?? 0);
                ViewContext.Writer.Write(
                    "<div style='text-align:center; line-height:1.2;'>" +
                        "<div>Thu nợ</div>" +
                        "<div style='color:#007bff; font-weight:bold; font-size:13px;'>" + total + "</div>" +
                    "</div>"
                );
            });
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Công nợ";
            column.FieldName = "CongNo";
            column.CellStyle.ForeColor = System.Drawing.Color.Red;
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.Visible = showExtraColumns;
            column.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Width = 100;
            // ✅ Header hiển thị tên cột + tổng
            column.SetHeaderTemplateContent(c =>
            {
                var total = string.Format("{0:N0}", ViewBag.Total_CongNo ?? 0);
                ViewContext.Writer.Write(
                    "<div style='text-align:center; line-height:1.2;'>" +
                        "<div>Công nợ</div>" +
                        "<div style='color:#007bff; font-weight:bold; font-size:13px;'>" + total + "</div>" +
                    "</div>"
                );
            });
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "HĐ Dở dang";
            column.FieldName = "DoDang";
            column.CellStyle.ForeColor = System.Drawing.Color.OrangeRed;
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.Visible = showExtraColumns;
            column.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Width = 100;
            // ✅ Header hiển thị tên cột + tổng
            column.SetHeaderTemplateContent(c =>
            {
                var total = string.Format("{0:N0}", ViewBag.Total_DoDang ?? 0);
                ViewContext.Writer.Write(
                    "<div style='text-align:center; line-height:1.2;'>" +
                        "<div>HĐ Dở dang</div>" +
                        "<div style='color:#007bff; font-weight:bold; font-size:13px;'>" + total + "</div>" +
                    "</div>"
                );
            });
        });


        settings.Columns.Add(column =>
        {
            column.Caption = "TB đã KĐ";
            column.FieldName = "TotalEquipment";
            column.CellStyle.ForeColor = System.Drawing.Color.Blue;
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.CellStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Visible = showExtraColumns;
            column.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Width = 60;
            // ✅ Header hiển thị tên cột + tổng
            column.SetHeaderTemplateContent(c =>
            {
                var total = string.Format("{0:N0}", ViewBag.Total_TotalEquipment ?? 0);
                ViewContext.Writer.Write(
                    "<div style='text-align:center; line-height:1.2;'>" +
                        "<div>TB đã KĐ</div>" +
                        "<div style='color:#007bff; font-weight:bold; font-size:13px;'>" + total + "</div>" +
                    "</div>"
                );
            });
        });

        settings.Columns.Add(column =>
        {
            column.Caption = "H.Sơ";
            column.FieldName = "DocCount";
            column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
            column.PropertiesEdit.DisplayFormatString = "N0";
            column.CellStyle.ForeColor = System.Drawing.Color.OrangeRed;
            column.Width = 60;
            column.CellStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;

        });

        settings.Columns.Add(column =>
        {
            column.Caption = "Kết thúc";
            column.FieldName = "Finished";            
            column.ColumnType = MVCxGridViewColumnType.CheckBox;
            column.Settings.AllowSort = DefaultBoolean.False;
            column.CellStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            column.Width = 50;
            if (User.IsInRole("Admin")) column.Visible = showExtraColumns;
            else column.Visible = false;
            // ✅ Checkbox từng dòng (khi là Admin)
            column.SetDataItemTemplateContent(c =>
            {
                var rowIndex = c.VisibleIndex;
                var finishedValue = Convert.ToBoolean(DataBinder.Eval(c.DataItem, "Finished"));
                var isChecked = finishedValue ? "checked" : "";
                var disabled = (User.IsInRole("Admin") == null || !(bool)User.IsInRole("Admin")) ? "disabled" : ""; // chỉ Admin mới được sửa

                ViewContext.Writer.Write(string.Format(
                                            "<input type='checkbox' data-rowindex='{0}' {1} {2} onclick='OnFinishedCheckBoxChanged(this)' />",
                                            rowIndex,
                                            isChecked,
                                            disabled
                                        ));
            });

        });

        settings.HtmlDataCellPrepared = (s, e) =>
        {
            if (e.DataColumn.FieldName == "XuatHoaDon")
            {
                if (e.CellValue != null && Convert.ToDecimal(e.CellValue) == 0)
                {
                    e.Cell.Text = ""; // 👉 hiển thị trống khi = 0
                }
            }
            if (e.DataColumn.FieldName == "ThuNo")
            {
                if (e.CellValue != null && Convert.ToDecimal(e.CellValue) == 0)
                {
                    e.Cell.Text = ""; // 👉 hiển thị trống khi = 0
                }
            }
            if (e.DataColumn.FieldName == "CongNo")
            {
                if (e.CellValue != null && Convert.ToDecimal(e.CellValue) == 0)
                {
                    e.Cell.Text = ""; // 👉 hiển thị trống khi = 0
                }
            }
            if (e.DataColumn.FieldName == "DoDang")
            {
                if (e.CellValue != null && Convert.ToDecimal(e.CellValue) == 0)
                {
                    e.Cell.Text = ""; // 👉 hiển thị trống khi = 0
                }
            }
            if (e.DataColumn.FieldName == "TotalEquipment")
            {
                if (e.CellValue != null && Convert.ToDecimal(e.CellValue) == 0)
                {
                    e.Cell.Text = ""; // 👉 hiển thị trống khi = 0
                }
            }

            if (e.DataColumn.FieldName == "DocCount")
            {
                int docCount = 0;
                if (e.CellValue != null && int.TryParse(e.CellValue.ToString(), out docCount) && docCount > 0)
                {
                    var contractIdObj = e.GetValue("Id");
                    var contractId = contractIdObj != null ? contractIdObj.ToString() : "";

                    // dùng string.Format thay cho $"..."
                    e.Cell.Text = e.CellValue + string.Format(
                                                                        "<span class='pdf-link' data-id='{0}' style='text-decoration:underline'>pdf</span>",
                                                                        contractId
                                                                    );
                }
                else
                {
                    e.Cell.Text = ""; // không có hồ sơ thì để trống
                }
            }

        };

        settings.HtmlDataCellPrepared += (sender, e) =>
        {
            if (e.DataColumn.FieldName == "CustomerName" || e.DataColumn.FieldName == "Name")
            {
                string text = e.CellValue == null ? string.Empty : e.CellValue.ToString();
                var lettercount = e.DataColumn.FieldName == "CustomerName" ? 60 : 40;
                if (!string.IsNullOrEmpty(text) && text.Length > lettercount)
                {
                    e.Cell.Text = text.Substring(0, lettercount) + " ...";
                    e.Cell.ToolTip = e.CellValue.ToString();
                }
            }
        };

        settings.BeforeGetCallbackResult = (sender, e) =>
        {
            MVCxGridView gridView = sender as MVCxGridView;
            if (gridView.IsNewRowEditing)
            {
                gridView.SettingsText.CommandUpdate = "Lưu lại";
                gridView.SettingsText.CommandCancel = "Hủy bỏ";
            }
            else
            {
                gridView.SettingsText.CommandUpdate = "Cập nhật";
                gridView.SettingsText.CommandCancel = "Hủy bỏ";
            }
        };

        settings.PreRender = (sender, e) =>
        {
            MVCxGridView gridView = sender as MVCxGridView;
            if (gridView != null)
            {
                gridView.ExpandAll();
            }

        };

        settings.CellEditorInitialize = (s, e) =>
        {
            ASPxEdit editor = (ASPxEdit)e.Editor;
            editor.ValidationSettings.Display = Display.Dynamic;
        };

        settings.ClientSideEvents.FocusedRowChanged = "OnGridFocusedRowChanged";

        settings.ClientSideEvents.EndCallback = "OnGridContractsEndCallBack";

        settings.AfterPerformCallback = (sender, e) =>
        {
            var gridView = ((MVCxGridView)sender);
            gridView.JSProperties.Add("cpIsCustomCallback", null);
            gridView.JSProperties["cpIsCustomCallback"] = e.CallbackName == "CUSTOMCALLBACK";

        };

        // 🎯 Quan trọng: style cho thanh pager
        settings.Styles.PagerBottomPanel.CssClass = "custom-grid-pager";

    });

    if (ViewData["EditError"] != null)
    {
        grid.SetEditErrorText((string)ViewData["EditError"]);
    }

}
@grid.BindToCustomData(Model).GetHtml()

<style>
    /*Đặt giảm chiều cao thanh đáy hiển thị số trang (trang 1 2 3 ....)*/
    .custom-grid-pager {
        height: 30px !important;
        padding: 0 4px !important;
        line-height: 30px !important; /* 👈 căn giữa theo chiều cao */
        font-size: 12px !important;
        align-items: center !important;
        justify-content: center !important; /* tuỳ chọn: căn giữa ngang luôn */
    }
</style>


<script type="text/javascript">
    function setGridHeight() {
        var availableHeight = window.innerHeight - 80; // trừ đi header, toolbar, footer
        var grid = ASPxClientControl.GetControlCollection().GetByName('grvContracts');
        if (grid) {
            grid.SetHeight(availableHeight);
        }
    }

    // chạy khi load và khi resize
    $(document).ready(setGridHeight);
    $(window).resize(setGridHeight);


</script>
<script type="text/javascript">
    function OnFinishedCheckBoxChanged(el) {
        var grid = window.grvContracts || ASPxClientGridView.Cast("grvContracts");
        if (!grid) return;

        var rowIndex = parseInt(el.getAttribute("data-rowindex"), 10);
        var id = grid.GetRowKey(rowIndex);
        var finished = el.checked;

        $.ajax({
            type: "POST",
            url: '/Contracts/UpdateFinishedStatus',
            data: {
                id: id,
                finished: finished
            },
            success: function (response) {
                if (response.success) {
                    DevExpress.ui.notify("Đã cập nhật trạng thái hợp đồng!", "success", 1500);
                } else {
                    DevExpress.ui.notify(response.message || "Cập nhật thất bại!", "error", 2000);
                    el.checked = !finished; // revert lại nếu lỗi
                }
            },
            error: function () {
                DevExpress.ui.notify("Lỗi kết nối server!", "error", 2000);
                el.checked = !finished;
            }
        });
    }

</script>


@* ẩn các cột tạm thời chưa dùng đến để tăng tốc độ
    settings.Columns.Add(column =>
    {
        column.Caption = "Khoán Cty";
        column.FieldName = "RatioOfCompany";
        column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
        column.PropertiesEdit.DisplayFormatString = "N0";
        column.Visible = false;
    });

    settings.Columns.Add(column =>
    {
        column.Caption = "Giá trị khoán Cty";
        column.FieldName = "ValueRoC";
        column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
        column.PropertiesEdit.DisplayFormatString = "N0";
        column.Visible = false;
    });

    settings.Columns.Add(column =>
    {
        column.Caption = "H.thành khoán Cty";
        column.FieldName = "IsCompletedIPoC";
        column.UnboundType = DevExpress.Data.UnboundColumnType.Boolean;
        column.Visible = false;
    });

    settings.Columns.Add(column =>
    {
        column.Caption = "Khoán C.Nhân";
        column.FieldName = "RatioOfInternal";
        column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
        column.PropertiesEdit.DisplayFormatString = "N0";
        column.Visible = false;
    });

    settings.Columns.Add(column =>
    {
        column.Caption = "H.thành khoán C.Nhân";
        column.FieldName = "IsCompletedIPoI";
        column.UnboundType = DevExpress.Data.UnboundColumnType.Boolean;
        column.Visible = false;
    });

    settings.Columns.Add(column =>
    {
        column.Caption = "Giá trị Khoán C.Nhân";
        column.FieldName = "ValueRoI";
        column.UnboundType = DevExpress.Data.UnboundColumnType.Decimal;
        column.PropertiesEdit.DisplayFormatString = "N0";
        column.Visible = false;
    });

    settings.Columns.Add(column =>
    {
        column.Caption = "TT";
        column.FieldName = "Status";
        column.Width = System.Web.UI.WebControls.Unit.Pixel(40);
        column.Visible = false;
        column.CellStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        column.SetDataItemTemplateContent(cell =>
        {
            if (cell.Text == "Chờ duyệt")
            {
                ViewContext.Writer.Write("<i class=\"fa fa-check-circle-o\" style=\"color: orange; font-size: 20px;\" title=\"Chờ duyệt\"></i>");
            }
            else if (cell.Text == "Đ&#227; duyệt")
            {
                ViewContext.Writer.Write("<i class=\"fa fa-check-circle\" style=\"color: deepskyblue; font-size: 20px;\" title=\"Đã duyệt\"></i>");
            }
            else if (cell.Text == "Đ&#227; cấp số")
            {
                ViewContext.Writer.Write("<i class=\"fa fa-check-circle\" style=\"color: green; font-size: 20px;\" title=\"Đã cấp số\"></i>");
            }

        });
    });
*@